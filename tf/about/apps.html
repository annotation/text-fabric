<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>tf.about.apps API documentation</title>
<meta name="description" content="Advanced API â€¦">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>tf.about.apps</code></h1>
</header>
<section id="section-intro">
<h1 id="advanced-api">Advanced API</h1>
<p>TF is a generic engine to process text and annotations.</p>
<p>When working with specific corpora, we want to have more power at our fingertips.</p>
<p>We need extra power on top of the core TF engine.</p>
<p>The way we have chosen to do it is via <em>apps</em>.
An app is a bunch of extra settings and / or functions and / or styles
that feed the advance API.</p>
<p>The advanced API will do its best to generate sensible default settings from
the corpus data, but a bit of nudging will usually improve the results of displaying
structures of the corpus.</p>
<p>For a list of current corpora, see <code><a title="tf.about.corpora" href="corpora.html">tf.about.corpora</a></code>.</p>
<h2 id="components">Components</h2>
<p>Apps usually reside in a subdirectory <code>app</code> of a repository that holds the corpus data.
Apps can be trivial, completely empty even.</p>
<p>Each TF <em>app</em> consists of a folder with these items, all optional:</p>
<h3 id="static">static</h3>
<p>A folder with styles, fonts and logos, to be used by web servers such as the
TF browser, see <code><a title="tf.browser.web" href="../browser/web.html">tf.browser.web</a></code>.</p>
<p>In particular, <code>display.css</code> contains additional styles used for pretty displays.
These styles will be programmatically combined with other styles,
to deliver them to the TF browser on the one hand, and to Jupyter notebooks
on the other hand.</p>
<h3 id="configyaml">config.yaml</h3>
<p>Settings to feed the advanced API for this app. See <code><a title="tf.advanced.settings" href="../advanced/settings.html">tf.advanced.settings</a></code>.</p>
<h3 id="apppy">app.py</h3>
<p>Corpus dependent helpers for the advanced API.</p>
<h3 id="other-modules">other modules</h3>
<p>If you organize bits of the functionality of a corpus app into modules
to be imported by <code>app.py</code>, you can put them in this same directory.</p>
<div class="admonition caution">
<p class="admonition-title">Do not <code>import</code> app-dependent modules</p>
<p>If you import these other modules by means of the Python import system using
<code>import module</code> or <code>from module import name</code> then everything works fine until you
load two apps in the same program, that in turn load their other modules.
As long as different apps load modules with different names, there is no problem.
But if two apps both have a module with the same name, then the first of them
will be loaded, and both apps use the same code.</p>
<p>In order to prevent this, you can use the function <code>loadModule()</code> to
dynamically load these modules. They will be given an app-dependent internal
name, so the Python importer will not conflate them.</p>
</div>
<div class="admonition explanation">
<p class="admonition-title"><code>loadModule()</code></p>
<p>Here is how you load auxiliary modules in your <code>app.py</code>.
The example is taken from the <code>uruk</code> app, which loads
two modules, <code>atf</code> and <code>image</code>.</p>
</div>
<p>See for example the
<a href="https://github.com/Nino-cunei/uruk/tree/master/app">app in the Uruk corpus</a>.</p>
<p>The place to put the <code>loadModule()</code> calls is in the <code>__init()__</code> method of the
<code>TfApp</code> object, before the call to <code>super().__init()</code>.
Here the name of the app and the path to the code directory of the
app are known.</p>
<p>The first argument for <code>loadModule()</code> is the file name of the module,
without the <code>.py</code>.</p>
<p><code>loadModule()</code> needs the app name and the path to the code,
but we pass it all <code>*args</code>, received by <code>__init__()</code>.</p>
<p>The result of loading the module is a code object,
from which you can get all the names defined by the module and their semantics.</p>
<p>In the <code>atf</code> case, we use the <code>atfApi()</code> function of the module to add
a bunch of functions defined in that module as methods to the <code>TfApp</code> object.</p>
<p>In the <code>image</code> case, we add the code object as an attribute to the <code>TfApp</code> object,
so that all its methods can retrieve all names defined by the <code>image</code> module.</p>
<h2 id="implementation">Implementation</h2>
<p>Most parts of the advanced API are implemented in the
<a href="https://github.com/annotation/text-fabric/blob/master/tf/advanced">API</a>
modules of TF.</p>
<h3 id="two-contexts">Two contexts</h3>
<p>Most functions with the <code>app</code> argument are meant to perform their duty
in two contexts:</p>
<ul>
<li>when called in a Jupyter notebook they deliver output meant
for a notebook output cell, using methods provided by the <code>ipython</code> package.</li>
<li>when called by the web app they deliver output meant for the TF browser website,
generating raw HTML.</li>
</ul>
<p>When we construct the rich, app-dependent API,
we let it know whether it is constructed for the purposes of the Jupyter notebook,
or for the purposes of the web app.</p>
<p>We set the attribute <code>_browse</code> on the <code>app</code> object to <code>True</code>
if we use the <code>app</code> in the web app context, otherwise in a programming context.</p>
<p>Most of the code in most functions is independent of <code>_browse</code>.
The main difference is how to deliver the result:
by a call to an <code>IPython</code> display method, or by returning raw HTML.</p>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<p><a href="https://github.com/annotation" title="annotation on GitHub"><img src="../../tf/images/tf-small.png" alt="annotation"></a></p>
<p><a href="../../tf/index.html">tf home</a> -
<a href="../../tf/cheatsheet.html">cheat sheet</a> -
<a href="https://github.com/annotation/text-fabric" title="GitHub repo"><img src="../../tf/images/GitHub_Logo.png" alt="GitHub" width="50"></a></p>
</p>
<form>
<input id="lunr-search" name="q" placeholder="ðŸ”Ž Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.16.0/tingle.min.css" integrity="sha512-b+T2i3P45i1LZM7I00Ci5QquB9szqaxu+uuk5TUSGjZQ4w4n+qujQiIuvTv2BxE7WCGQCifNMksyKILDiHzsOg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.16.0/tingle.min.js" integrity="sha512-2B9/byNV1KKRm5nQ2RLViPFD6U4dUjDGwuW1GU+ImJh8YinPU9Zlq1GzdTMO+G2ROrB5o1qasJBy1ttYz0wCug==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<div class="toc">
<ul>
<li><a href="#advanced-api">Advanced API</a><ul>
<li><a href="#components">Components</a><ul>
<li><a href="#static">static</a></li>
<li><a href="#configyaml">config.yaml</a></li>
<li><a href="#apppy">app.py</a></li>
<li><a href="#other-modules">other modules</a></li>
</ul>
</li>
<li><a href="#implementation">Implementation</a><ul>
<li><a href="#two-contexts">Two contexts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="tf.about" href="index.html">tf.about</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<a href="https://pure.knaw.nl/portal/en/persons/dirk-roorda">Dirk Roorda</a>
<a href="https://huc.knaw.nl"><img alt="HuC" src="../../tf/images/huc.png" width="200" alt="Humanities Cluster"></a>
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
