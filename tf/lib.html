<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.11.1" />
<title>tf.lib API documentation</title>
<meta name="description" content="Utility functions â€¦" />
<!-- integrity SRI from https://cdnjs.com/libraries/10up-sanitize.css/11.0.1 -->
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css"
integrity="sha512-kcbluZFacWN57NgWZ4aH6eUMBEaTyErFhIFD3y5qYZbKuuyImH0K/AKsBbfXlivh2z5C+3IDTIhI11YmKomzmA=="
crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css"
integrity="sha512-uVeAgzAmieLUTGba0qr9vXQgVD7fko2kcbYIKIraXUIDg9iJLxveTFUrg3DJhqn3cAf3HFDbgmhq0eGko5wEAA=="
crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>tf.lib</code></h1>
</header>
<section id="section-intro">
<h1 id="utility-functions">Utility functions</h1>
<p>Read and write TF node sets from / to file.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/annotation/text-fabric/blob/8966cfdaddd42b3c658be49bae545eec192300e0/tf/lib.py#L1-L172" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
# Utility functions

Read and write TF node sets from / to file.
&#34;&#34;&#34;

import pickle
import gzip
from .parameters import PICKLE_PROTOCOL, GZIP_LEVEL
from .core.helpers import console
from .core.files import fileOpen, expanduser as ex, fileExists, dirMake, splitPath


def writeList(data, dest, intCols=None):
    &#34;&#34;&#34;Writes a list of tuples sets to a TSV file.

    The members of the tuples will be written
    as string values in tab separated lines, with newlines and tabs
    escaped with backslashes.

    The first line consists of tab-separated values that are either the
    string `str` or the string `int`, indicating the type of values of the
    corresponding column.
    values are supposed to be integers.

    Intended use: if you have data from an NLP pipeline, it usually comes as a list
    of tuples, where each tuple has two position columns plus extra columns
    for linguistic features, which are strings or numbers.

    If there is no data, an empty file is created, with a header line.
    If `intCols` is not given, the header line itself is empty.

    !!! caution &#34;Equal length&#34;
        It is assumed that all tuples have equal length.

    Parameters
    ----------
    data: list of tuples
    dest: string
        A file path. You may use `~` to refer to your home directory.
        The result will be written from this file.
    intCols: tuple, optional None
        A sequence of boolean values, indicating which columns have integer values.
        If None, all columns are of type string.

    Returns
    -------
    boolean
        `True` if all went well, `False` otherwise.
    &#34;&#34;&#34;

    destPath = ex(dest)
    (baseDir, fileName) = splitPath(destPath)

    dirMake(baseDir)

    with fileOpen(destPath, mode=&#34;w&#34;) as fh:
        if intCols is None:
            intCols = {i: False for i in range(len(data[0]))} if len(data) else {}
        else:
            intCols = {i: isInt for (i, isInt) in enumerate(intCols)}

        headLine = &#34;\t&#34;.join(&#34;int&#34; if intCols[i] else &#34;str&#34; for i in sorted(intCols))
        fh.write(f&#34;{headLine}\n&#34;)

        for fields in data:
            dataLine = &#34;\t&#34;.join(
                str(f) if intCols[i] else str(f).replace(&#34;\t&#34;, &#34;\\t&#34;).replace(&#34;\n&#34;, &#34;\\n&#34;)
                for (i, f) in enumerate(fields)
            )
            fh.write(f&#34;{dataLine}\n&#34;)
    return True


def readList(source):
    &#34;&#34;&#34;Reads list of tuples from a TSV file.

    The first line of the TSV file will be interpreted as the types of the
    columns.

    Parameters
    ----------
    source: string
        A file path. You may use `~` to refer to your home directory.
        This file must contain a `gzipped`, `pickled` data structure.

    Returns
    -------
    data | boolean
        The list of tuples obtained from the file if all went well, False otherwise.

    &#34;&#34;&#34;

    sourcePath = ex(source)
    if not fileExists(sourcePath):
        console(f&#39;Sets file &#34;{source}&#34; does not exist.&#39;)
        return False

    data = []

    with fileOpen(sourcePath) as fh:
        colInt = {
            i: tp == &#34;int&#34; for (i, tp) in enumerate(next(fh).rstrip(&#34;\n&#34;).split(&#34;\t&#34;))
        }
        for line in fh:
            fields = tuple(
                int(f) if colInt[i] else f.replace(&#34;\\n&#34;, &#34;\n&#34;).replace(&#34;\\t&#34;, &#34;\t&#34;)
                for (i, f) in enumerate(line.rstrip(&#34;\n&#34;).split(&#34;\t&#34;))
            )
            data.append(fields)

    return data


def writeSets(sets, dest):
    &#34;&#34;&#34;Writes a dictionary of named sets to file.

    The dictionary will be written as a `gzipped`, `pickled` data structure.

    Intended use: if you have constructed custom node sets that you want to use
    in search templates that run in the TF browser.

    Parameters
    ----------
    sets: dict of sets
        The keys are names for the values, which are sets of nodes.
    dest: string
        A file path. You may use `~` to refer to your home directory.
        The result will be written from this file.

    Returns
    -------
    boolean
        `True` if all went well, `False` otherwise.
    &#34;&#34;&#34;

    destPath = ex(dest)
    (baseDir, fileName) = splitPath(destPath)

    dirMake(baseDir)

    with gzip.open(destPath, mode=&#34;wb&#34;, compresslevel=GZIP_LEVEL) as f:
        pickle.dump(sets, f, protocol=PICKLE_PROTOCOL)
    return True


def readSets(source):
    &#34;&#34;&#34;Reads a dictionary of named sets from file.

    This is used by the TF browser, when the user has passed a
    `--sets=fileName` argument to it.

    Parameters
    ----------
    source: string
        A file path. You may use `~` to refer to your home directory.
        This file must contain a `gzipped`, `pickled` data structure.

    Returns
    -------
    data | boolean
        The data structure contained in the file if all went well, False otherwise.

    &#34;&#34;&#34;

    sourcePath = ex(source)
    if not fileExists(sourcePath):
        console(f&#39;Sets file &#34;{source}&#34; does not exist.&#39;)
        return False
    with gzip.open(sourcePath, mode=&#34;rb&#34;) as f:
        sets = pickle.load(f)
    return sets</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="tf.lib.readList"><code class="name flex">
<span>def <span class="ident">readList</span></span>(<span>source)</span>
</code></dt>
<dd>
<div class="desc"><p>Reads list of tuples from a TSV file.</p>
<p>The first line of the TSV file will be interpreted as the types of the
columns.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>source</code></strong> :&ensp;<code>string</code></dt>
<dd>A file path. You may use <code>~</code> to refer to your home directory.
This file must contain a <code>gzipped</code>, <code>pickled</code> data structure.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>data | boolean</code></dt>
<dd>The list of tuples obtained from the file if all went well, False otherwise.</dd>
</dl></div>
</dd>
<dt id="tf.lib.readSets"><code class="name flex">
<span>def <span class="ident">readSets</span></span>(<span>source)</span>
</code></dt>
<dd>
<div class="desc"><p>Reads a dictionary of named sets from file.</p>
<p>This is used by the TF browser, when the user has passed a
<code>--sets=fileName</code> argument to it.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>source</code></strong> :&ensp;<code>string</code></dt>
<dd>A file path. You may use <code>~</code> to refer to your home directory.
This file must contain a <code>gzipped</code>, <code>pickled</code> data structure.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>data | boolean</code></dt>
<dd>The data structure contained in the file if all went well, False otherwise.</dd>
</dl></div>
</dd>
<dt id="tf.lib.writeList"><code class="name flex">
<span>def <span class="ident">writeList</span></span>(<span>data, dest, intCols=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Writes a list of tuples sets to a TSV file.</p>
<p>The members of the tuples will be written
as string values in tab separated lines, with newlines and tabs
escaped with backslashes.</p>
<p>The first line consists of tab-separated values that are either the
string <code>str</code> or the string <code>int</code>, indicating the type of values of the
corresponding column.
values are supposed to be integers.</p>
<p>Intended use: if you have data from an NLP pipeline, it usually comes as a list
of tuples, where each tuple has two position columns plus extra columns
for linguistic features, which are strings or numbers.</p>
<p>If there is no data, an empty file is created, with a header line.
If <code>intCols</code> is not given, the header line itself is empty.</p>
<div class="admonition caution">
<p class="admonition-title">Equal length</p>
<p>It is assumed that all tuples have equal length.</p>
</div>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>data</code></strong> :&ensp;<code>list</code> of <code>tuples</code></dt>
<dd>&nbsp;</dd>
<dt><strong><code>dest</code></strong> :&ensp;<code>string</code></dt>
<dd>A file path. You may use <code>~</code> to refer to your home directory.
The result will be written from this file.</dd>
<dt><strong><code>intCols</code></strong> :&ensp;<code>tuple</code>, optional <code>None</code></dt>
<dd>A sequence of boolean values, indicating which columns have integer values.
If None, all columns are of type string.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>boolean</code></dt>
<dd><code>True</code> if all went well, <code>False</code> otherwise.</dd>
</dl></div>
</dd>
<dt id="tf.lib.writeSets"><code class="name flex">
<span>def <span class="ident">writeSets</span></span>(<span>sets, dest)</span>
</code></dt>
<dd>
<div class="desc"><p>Writes a dictionary of named sets to file.</p>
<p>The dictionary will be written as a <code>gzipped</code>, <code>pickled</code> data structure.</p>
<p>Intended use: if you have constructed custom node sets that you want to use
in search templates that run in the TF browser.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>sets</code></strong> :&ensp;<code>dict</code> of <code>sets</code></dt>
<dd>The keys are names for the values, which are sets of nodes.</dd>
<dt><strong><code>dest</code></strong> :&ensp;<code>string</code></dt>
<dd>A file path. You may use <code>~</code> to refer to your home directory.
The result will be written from this file.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>boolean</code></dt>
<dd><code>True</code> if all went well, <code>False</code> otherwise.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<p><a href="https://github.com/annotation" title="annotation on GitHub"><img src="../tf/images/tf-small.png" alt="annotation"></a></p>
<p><a href="../tf/index.html">tf home</a> -
<a href="../tf/cheatsheet.html">cheat sheet</a> -
<a href="https://github.com/annotation/text-fabric" title="GitHub repo"><img src="../tf/images/GitHub_Logo.png" alt="GitHub" width="50"></a></p>
</p>
<form>
<input id="lunr-search" name="q" placeholder="ðŸ”Ž Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#utility-functions">Utility functions</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="tf" href="index.html">tf</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="tf.lib.readList" href="#tf.lib.readList">readList</a></code></li>
<li><code><a title="tf.lib.readSets" href="#tf.lib.readSets">readSets</a></code></li>
<li><code><a title="tf.lib.writeList" href="#tf.lib.writeList">writeList</a></code></li>
<li><code><a title="tf.lib.writeSets" href="#tf.lib.writeSets">writeSets</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<a href="https://pure.knaw.nl/portal/en/persons/dirk-roorda">Dirk Roorda</a>
<a href="https://huc.knaw.nl"><img alt="HuC" src="../tf/images/huc.png" width="200" alt="Humanities Cluster"></a>
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
